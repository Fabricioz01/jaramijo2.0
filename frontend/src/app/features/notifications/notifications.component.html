<div class="notifications-container">
  <!-- Header -->
  <div class="notifications-header">
    <div class="d-flex justify-content-between align-items-center">
      <h6 class="mb-0 fw-bold">
        <i class="bi bi-bell me-2"></i>
        Notificaciones
      </h6>
      <div class="d-flex gap-2">
        <button
          class="btn btn-sm btn-outline-primary"
          (click)="markAllAsRead()"
          *ngIf="hasUnreadNotifications()"
          title="Marcar todas como leídas"
        >
          <i class="bi bi-check-all"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-4">
    <div class="spinner-border spinner-border-sm text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Lista de notificaciones -->
  <div class="notifications-list" *ngIf="!loading">
    <div
      *ngFor="let notification of notifications; trackBy: trackByNotificationId"
      class="notification-item"
      [class.unread]="!notification.read"
      (click)="navigateToTask(notification)"
    >
      <div class="notification-content">
        <div class="notification-icon">
          <i
            [class]="
              getNotificationIcon(notification.type) +
              ' ' +
              getNotificationColor(notification.type)
            "
            [title]="getNotificationTitle(notification.type)"
          >
          </i>
        </div>

        <div class="notification-body">
          <div class="notification-title">
            {{ getNotificationTitle(notification.type) }}
          </div>
          <div class="notification-message">
            {{ notification.message }}
          </div>
          <div class="notification-task" *ngIf="notification.task">
            <i class="bi bi-list-task me-1"></i>
            <strong>{{ notification.task.title }}</strong>
            <span *ngIf="notification.task.dueDate" class="ms-2 text-muted">
              <i class="bi bi-calendar me-1"></i>
              {{ notification.task.dueDate | date : "dd/MM/yyyy" }}
            </span>
          </div>
          <div class="notification-time">
            <i class="bi bi-clock me-1"></i>
            {{ getTimeAgo(notification.createdAt) }}
          </div>
        </div>

        <div class="notification-actions">
          <button
            class="btn btn-sm btn-outline-danger"
            (click)="deleteNotification(notification, $event)"
            title="Eliminar notificación"
          >
            <i class="bi bi-trash"></i>
          </button>
        </div>
      </div>

      <!-- Indicador de no leída -->
      <div class="unread-indicator" *ngIf="!notification.read"></div>
    </div>

    <!-- Empty state -->
    <div *ngIf="notifications.length === 0" class="empty-state">
      <div class="text-center py-4">
        <i class="bi bi-bell-slash text-muted display-4"></i>
        <h6 class="text-muted mt-2">No tienes notificaciones</h6>
        <p class="text-muted small">
          Te notificaremos cuando tengas nuevas tareas asignadas o cuando alguna
          esté por vencer.
        </p>
      </div>
    </div>
  </div>
</div>
